<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Find the ball</title>

<!-- zimjs.com - JavaScript Canvas Framework -->
<script type="module">

import zim from "https://zimjs.org/cdn/017/zim";

const assets = ["cat.png","bg.png","pixel.ttf","icon1.png","icon2.png","icon3.png",
"icon4.png","icon5.png","icon6.png","icon7.png","icon8.png","exit1.png","exit2.png",
"ball.png","right-arrow.png","ballbg.png","puzzlebg.png","puzzle.png"];
const path = "assets/";
// See Docs under Frame for FIT, FILL, FULL, and TAG
new Frame(FIT, 1024, 768, light, dark, ready, assets, path);
function ready() {
  part1();
  function addBackground(container) {
        //add background
        new Rectangle({
            width: W,
            height: H,
            color: "rgba(160, 153, 199, 1)"
        }).addTo(container);

        //add background image
        new Pic("bg.png").mov(0, 0).sca(0.256).addTo(container);
    }

function addDesk(container){
        const containerDesk = new Container().addTo(container);
        //add icons

        //add sticker1
        const title1 = new Container().addTo(containerDesk);
        const sticker1 = new Rectangle({
            width: 350,
            height: 120,
            color: "rgba(255, 255, 165, 1)",
        }).pos(340, 170).addTo(title1);      
        new Label({
            text: "// Welcome To the game\n// My friend.\n// Please read the game rule:",
            size: 23,
            color: "black",
            font: "pixel.ttf",
            align: "left"
        }).center(title1).addTo(title1);
        title1.on("mouseover", () => {
            title1.animate({
                props: { scale: 1.02 },
                time: 0.2,
                ease: "bounceOut",
            });
        });

        title1.on("mouseout", () => {
            title1.animate({
                props: { scale: 1 },
                time: 0.2,
                ease: "bounceIn",
            });
        });

        //add sticker2
        const title2 = new Container().addTo(containerDesk);       
        const sticker2 = new Rectangle({
            width: 540,
            height: 170,
            color: "rgba(165, 255, 217, 1)",
        }).pos(440, 340).addTo(title2);
        new Label({
            text: "you are the owner of the cat.\nhelp your cat find her  red ball...\nand if you do not, she will attack your computer!!!",    
            size: 20,
            color: "black",
            font: "pixel.ttf",
            align: "left",
            lineHeight: 30
        }).center(title2).addTo(title2)
        title2.on("mouseover", () => {
            title2.animate({
                props: { scale: 1.02 },
                time: 0.2,
                ease: "bounceOut",
            });
        });

        title2.on("mouseout", () => {
            title2.animate({
                props: { scale: 1 },
                time: 0.2,
                ease: "bounceIn",
            });
        });

        const title3 = new Label({
            text: "Are you ready?",
            size: 20,
            color: "black",
            font: "pixel.ttf",
            align: "left",
            lineHeight: 30
            }).pos(300, 580).addTo(containerDesk)
        title3.on("mouseover", function() {
        title3.color = "purple";
        })
        title3.on("mouseout", function() {
        title3.color = "black";
        });

        const title4 = new Label({
        text: "Click some icons to start finding...",
        size: 22,
        color: "black",
        font: "pixel.ttf",
        align: "left",
        lineHeight: 30
        }).pos(450, 640).addTo(containerDesk)
    title4.on("mouseover", function() {
            title4.color = "blue";
        })
        title4.on("mouseout", function() {
            title4.color = "black";
        });
}


function part1(){

        const container = new Container().addTo();
        addBackground(container);
        addDesk(container);
        
        //left side
        const icon1 = new Pic("icon6.png").pos(80, 100).addTo(container).sca(0.04);
        const icon2 = new Pic("icon1.png").pos(80, 220).addTo(container).sca(0.04);
        const icon3 = new Pic("icon7.png").pos(80, 350).addTo(container).sca(0.04);
        const icon4 = new Pic("icon2.png").pos(100, 470).addTo(container).sca(0.04);
        const icon5 = new Pic("icon8.png").pos(180, 570).addTo(container).sca(0.05);
        const icon6 = new Pic("icon3.png").pos(240, 120).addTo(container).sca(0.04);
        const icon7 = new Pic("icon3.png").pos(200, 280).addTo(container).sca(0.04);
        //right side
        const icon8 = new Pic("icon3.png").pos(800, 90).addTo(container).sca(0.04);
        const icon9 = new Pic("icon4.png").pos(740, 220).addTo(container).sca(0.06);
        const icon10 = new Pic("icon5.png").pos(850, 205).addTo(container).sca(0.04);
        
        
    //click icon
    icon2.on("click", () => {
        const puzzleContainer = new Container().addTo(container);
    // add the puzzle background frame
    new Pic("puzzlebg.png").pos(290, 121).addTo(puzzleContainer).sca(0.67)   

    new Rectangle({
        width: 433,
        height:433,
        color: grey,
    }).pos(312, 234).addTo(puzzleContainer);



    // load the puzzle image
    const puzzleImage = asset("puzzle.png").pos(290, 350).addTo(puzzleContainer); // upload the puzzle image

    // set 3x3 puzzle
    const gridSize = 3; 
    const picture = new Scrambler(chop(puzzleImage, gridSize, gridSize)).center(puzzleContainer); // center the puzzle

    // hide the original image
    puzzleImage.removeFrom();

    // listen the puzzle complete event
    picture.on("complete", function () {
        zog("Puzzle completed!");
         

        // add the complete animation
        const originalImage = puzzleImage.centerReg(container).sca(0.7).animate({
            props: { 
                rotation: 720,
                scale: 0.7 
            },
            time: 3.5,
            ease: "backInOut",
            call: function () {
                originalImage.removeFrom();
                // show the ball
                const overlayContainer = new Container().addTo(); 

                // add a dark overlay
                const darkOverlay = new Rectangle({
                    width: container.width, 
                    height: container.height,
                    color: "black",
                    alpha: 0 
                }).addTo(container);

                darkOverlay.animate({
                    props: { alpha: 0.7 }, 
                    time: 1.5, 
                });

                // show the ball
                const ball = new Pic("ball.png")
                    .pos(250, 120)
                    .sca(0.8)
                    .addTo(overlayContainer)
                    .animate({
                        props: { scale: 1 },  
                        time: 1,
                        ease: "backOut"
                    });

                const nextLabel2 = new Label({
                    text: "Restart",
                    size: 35,
                    color: black,
                    font: "pixel.ttf",
                    align: "center"
                }).pos(340, 410).addTo(ball);

                //add right arrow
                const rightArrow = new Pic("right-arrow.png")
                    .pos(485, 410)
                    .addTo(ball);

                //add next label
                const nextLabel1 = new Label({
                    text: "Congratulations!\n\nFind the ball!",
                    size: 45,
                    color: black,
                    font: "pixel.ttf",
                    align: "center"
                }).pos(276, 285).addTo(ball);
                
                
                
                //click the ball to next level
                ball.on("click", () => {              
                    container.removeFrom();
                    overlayContainer.removeFrom();
                    part1();
                });    
            },
        });

        // remove the puzzle
        puzzleContainer.removeFrom();
        S.update();
    });

   
});





   
}


} // end ready

</script>
<meta name="viewport" content="width=device-width, user-scalable=no" />
</head>
<body></body>
</html>